
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Roman Empire Vector Map Preview</title>
  <link rel="stylesheet" type="text/css" href="https://api.mapbox.com/mapbox-gl-js/v0.34.0/mapbox-gl.css" />
  <script src="https://api.mapbox.com/mapbox-gl-js/v0.34.0/mapbox-gl.js"></script>
  <style>
    body { margin:0; padding:0; }
    #map { position:absolute; top:0; bottom:0; width:100%; }
    #lang {position:absolute;left:10px;bottom:10px;}
  </style>
</head>
<body>
  <div id="map"></div>
  <select id="lang" onchange="updateStyle()">
    <option value="latin">Latin</option>
    <option value="greek">Greek</option>
    <option value="modern">Modern</option>
  </select>
  <script>
      var STYLE_JSON_URL = "style.json";
      var STYLE_JSON;

      mapboxgl.setRTLTextPlugin('https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.1.0/mapbox-gl-rtl-text.js');
      var map = new mapboxgl.Map({
        container: 'map',
        attributionControl: true,
        hash: true
      });

      var langEl = document.getElementById('lang');
      var updateStyle = function() {
        if (!STYLE_JSON) return;
        var language = langEl.value;
        var style = JSON.stringify(STYLE_JSON);
        style = style.replace(/\{(latin)\}/gi, '{' + language + '}');
        if (language == 'greek') {
          style = style.replace(/\"uppercase\"/gi, '"none"');
        }
        map.setStyle(JSON.parse(style));
      };

      var oReq = new XMLHttpRequest();
      oReq.onload = function() {
        STYLE_JSON = JSON.parse(this.responseText);
        updateStyle();
      };
      oReq.open('get', STYLE_JSON_URL, true);
      oReq.send();
  </script>
</body>
</html>
